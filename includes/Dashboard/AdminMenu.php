<?php

namespace Engramium\Optimator\Dashboard;

// If this file is called directly, abort.
defined('ABSPATH') || exit;

/**
 * Add dashboard menu class
 *
 * @author sayedulsayem
 * @since 1.0.0
 */
class AdminMenu {

    use \Engramium\Optimator\Traits\Singleton;

    private $slug = 'optimator-settings';

    /**
     * initialization function
     *
     * @return void
     * @since 1.0.0
     */
    public function init() {
        add_action('admin_menu', [$this, 'admin_menu']);
        add_action('in_admin_header', [$this, 'remove_all_notices'], PHP_INT_MAX);
    }

    /**
     * add admin menu function
     *
     * @return void
     * @since 1.0.0
     */
    public function admin_menu() {
        $capability = 'manage_options';
        $slug       = 'optimator-settings';

        add_menu_page(
            __('Optimator', 'optimator'),
            __('Optimator', 'optimator'),
            $capability,
            $this->slug,
            [$this, 'render_page'],
            'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIiBmaWxsPSJub25lIj4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8xXzIpIj4NCjxwYXRoIGQ9Ik0xMC4wMDgyIDIwLjAwMjJDOS4zMzE1MSAyMC4wMDI2IDguNjU2NDkgMTkuOTM1NCA3Ljk5MzE3IDE5LjgwMTdDNy4zMzk1MSAxOS42NzIgNi43MDA3NyAxOS40NzYgNi4wODY4NSAxOS4yMTY5QzUuNTAxNjIgMTguOTY0MSA0Ljk0MTcxIDE4LjY1NjQgNC40MTQ2NCAxOC4yOThDMy44ODMwMSAxNy45NDAyIDMuMzg3MzkgMTcuNTMxNyAyLjkzNDczIDE3LjA3ODNDMi40ODAwNCAxNi42MjY4IDIuMDcxMTUgMTYuMTMxNSAxLjcxNDAyIDE1LjU5OTZDMS4zNDk5NSAxNS4wNzQ4IDEuMDM5MDYgMTQuNTE1IDAuNzg1OTQyIDEzLjkyODdDMC41MzIwMDIgMTMuMzIyIDAuMzM2MDM5IDEyLjY5MjYgMC4yMDA2NjkgMTIuMDQ5Qy0wLjA2Njg4OTYgMTAuNzIwMSAtMC4wNjY4ODk2IDkuMzUxMjEgMC4yMDA2NjkgOC4wMjIyOEMwLjMzNjAzOSA3LjM3ODY4IDAuNTMyMDAyIDYuNzQ5MzIgMC43ODU5NDIgNi4xNDI1OEMxLjAzODY2IDUuNTU2MDUgMS4zNDk1NyA0Ljk5NjMxIDEuNzE0MDIgNC40NzE3NEMyLjA1NTU4IDMuOTE3NTMgMi40NTY0OSAzLjQwMjEgMi45MDk2NSAyLjkzNDU2QzMuMzU3OTUgMi40NzYzNSAzLjg1NDA4IDIuMDY3NDUgNC4zODk1NiAxLjcxNDg0QzQuOTE0NTYgMS4zNTA2OSA1LjQ3NDc2IDEuMDQwMDQgNi4wNjE3NyAwLjc4NzUyNUM2LjY3NzA4IDAuNTMyMjggNy4zMTU0MyAwLjMzNjQ1NiA3Ljk2ODA5IDAuMjAyNzNDOC42Mzk2MiAwLjA2NzM5MTggOS4zMjMxMyAwLjAwMDIxNjY1NyAxMC4wMDgyIDAuMDAyMjI4NjZDMTAuNjQ3NCAtMC4wMTUxNzQgMTEuMjg1MyAwLjA2OTQzMTUgMTEuODk3OCAwLjI1Mjg1NUMxMi40MDI1IDAuNDA1NTYgMTIuODQzMSAwLjcxOTYwNSAxMy4xNTE5IDEuMTQ2NzZDMTMuMzY5IDEuNDg0NTMgMTMuNDkzIDEuODczNTcgMTMuNTExNSAyLjI3NDU4QzEzLjUxMjYgMi42NjQzOSAxMy40NTkxIDMuMDUyNDUgMTMuMzUyNiAzLjQyNzQ2QzEzLjEyOTkgNC4yMzY5MyAxMi44NTA1IDUuMDI5NzUgMTIuNTE2NSA1LjgwMDA2QzExLjg5MTkgNy4xMTMyNyAxMS41MDk1IDguNTI4MyAxMS4zODc4IDkuOTc3MTdDMTEuNTUxMyAxMS4zMzE5IDExLjkzODQgMTIuNjUwMiAxMi41MzMyIDEzLjg3ODZDMTIuODkxMyAxNC42NzUzIDEzLjE4NDkgMTUuNDk5NSAxMy40MTExIDE2LjM0MzFDMTMuNTI3IDE2LjczMzYgMTMuNTg2MiAxNy4xMzg4IDEzLjU4NjcgMTcuNTQ2MUMxMy41NzQ2IDE3Ljk2NzYgMTMuNDQ3MyAxOC4zNzc4IDEzLjIxODggMTguNzMyNEMxMi45MTE4IDE5LjE3NzYgMTIuNDY4OSAxOS41MTE3IDExLjk1NjMgMTkuNjg0OEMxMS4zMjkxIDE5Ljg5ODIgMTAuNjcwNyAyMC4wMDU1IDEwLjAwODIgMjAuMDAyMlpNMTAuMDA4MiAxLjU3MjgyQzcuNzcwNzQgMS41NzI4MiA1LjYyNDkzIDIuNDYwOTIgNC4wNDI4MiA0LjA0MTc0QzIuNDYwNyA1LjYyMjU2IDEuNTcxODggNy43NjY2MSAxLjU3MTg4IDEwLjAwMjJDMS41NzE4OCAxMi4yMzc4IDIuNDYwNyAxNC4zODE5IDQuMDQyODIgMTUuOTYyN0M1LjYyNDkzIDE3LjU0MzUgNy43NzA3NCAxOC40MzE2IDEwLjAwODIgMTguNDMxNkMxMS4wMzY2IDE4LjQzMTYgMTEuNjgwNCAxOC4yMDYxIDExLjkzOTYgMTcuODgwM0MxMi4wODYxIDE3LjUwNDEgMTIuMDg2MSAxNy4wODY4IDExLjkzOTYgMTYuNzEwN0MxMS43MTUzIDE1Ljk0NzkgMTEuNDM1OCAxNS4yMDI0IDExLjEwMzUgMTQuNDgwMUMxMC44MTkyIDEzLjc4NjcgMTAuNTE4MiAxMy4wNjgyIDEwLjI2NzQgMTIuMzMzMUMxMC4wMjQ3IDExLjU4NzEgOS44ODY4NiAxMC44MTExIDkuODU3NjkgMTAuMDI3M0M5Ljk1ODk2IDguMzU5MDYgMTAuMzc5IDYuNzI1NjQgMTEuMDk1MSA1LjIxNTI2QzExLjM5NDIgNC41MjExNCAxMS42NDI5IDMuODA2NCAxMS44MzkzIDMuMDc2NThDMTEuOTY5NSAyLjc0MDY1IDExLjk2OTUgMi4zNjgyMyAxMS44MzkzIDIuMDMyM0MxMS43MjIgMS44OTEyNiAxMS41NjQ1IDEuNzg5MjcgMTEuMzg3OCAxLjczOTkxQzEwLjkzODggMS42MTU4MyAxMC40NzM4IDEuNTU5NTEgMTAuMDA4MiAxLjU3MjgyWiIgZmlsbD0iI0YwRjZGQyIvPg0KPHBhdGggZD0iTTE0LjQzOTUgMC45NzEzMThDMTUuMTIyMSAxLjM1NDkgMTUuNjMxIDEuOTg2MDIgMTUuODYwOSAyLjczNDA2QzE1Ljk5ODkgMy4yMDI3NCAxNi4wMzU5IDMuNjk1MzIgMTUuOTY5NiA0LjE3OTM0QzE1LjY5NjUgNS40NTc0MiAxNS4zMzA0IDYuNzEzODkgMTQuODc0MyA3LjkzODc0QzE0LjY3MTIgOC41OTE0MSAxNC41NTg2IDkuMjY4ODUgMTQuNTM5OSA5Ljk1MjFDMTQuNTM1NyAxMC4wMjE3IDE0LjUzNTcgMTAuMDkxNCAxNC41Mzk5IDEwLjE2MUMxNC41ODU4IDEwLjg1MTYgMTQuNzI5NCAxMS41MzIzIDE0Ljk2NjMgMTIuMTgyN0MxNS40NTU0IDEzLjMxODYgMTUuODUyNCAxNC40OTIgMTYuMTUzNiAxNS42OTE1QzE2LjI3MTUgMTYuMzE3NCAxNi4xOTU2IDE2Ljk2NDMgMTUuOTM2MiAxNy41NDYxQzE1LjYwNTYgMTguMTU5OSAxNS4wNzg3IDE4LjY0NTIgMTQuNDM5NSAxOC45MjQ1QzE0LjcwNDUgMTguNjI3NiAxNC45MzE5IDE4LjI5OTQgMTUuMTE2OCAxNy45NDcxQzE1LjI1NzQgMTcuNjYyMiAxNS4zNDI1IDE3LjM1MzIgMTUuMzY3NiAxNy4wMzY1QzE1LjMzMjcgMTYuMjYzNyAxNS4wOTk1IDE1LjUxMjggMTQuNjkwNCAxNC44NTZDMTQuMzE0MSAxNC4xMzc2IDEzLjkwNDQgMTMuNDE5MSAxMy41ODY3IDEyLjY1ODlDMTMuNDExIDEyLjI1MzMgMTMuMjY4NCAxMS44MzQzIDEzLjE2MDMgMTEuNDA1N0MxMy4wMiAxMC44Nzc0IDEyLjk1OCAxMC4zMzEzIDEyLjk3NjQgOS43ODUwMkMxMy4xMjI5IDguMTQ5OTIgMTMuNjM0MyA2LjU2ODQyIDE0LjQ3MyA1LjE1Njc4QzE0Ljc1NDUgNC42MjY5OCAxNC45NzMzIDQuMDY2MjcgMTUuMTI1MSAzLjQ4NTk0QzE1LjE3MSAzLjI2OTEzIDE1LjE4NzkgMy4wNDcyIDE1LjE3NTMgMi44MjU5NkMxNS4xMjMxIDIuMTUwMjIgMTQuODY2NSAxLjUwNjMxIDE0LjQzOTUgMC45Nzk2NzJWMC45NzEzMThaIiBmaWxsPSIjRjBGNkZDIi8+DQo8cGF0aCBkPSJNMTcuMjY1NiAzLjE2ODQ4QzE3LjYwODIgMy40MTAwNCAxNy44OTM2IDMuNzIzNzMgMTguMTAxNyA0LjA4NzQ0QzE4LjQ0MzYgNC43NTc1NCAxOC41MzgzIDUuNTI2NTkgMTguMzY5MiA2LjI1OTU0QzE4LjE2ODYgNy4yNTM2OSAxNy43NTA1IDguMTk3NzIgMTcuNjE2NyA5LjE5MTg3QzE3LjU2NjMgOS40Njc2MiAxNy41MzgzIDkuNzQ3MDEgMTcuNTMzMSAxMC4wMjczQzE3LjUzMzEgMTAuMTM1OSAxNy41MzMxIDEwLjIzNjEgMTcuNTMzMSAxMC4zNDQ4QzE3LjYyMTYgMTEuMDE0MyAxNy43ODEzIDExLjY3MjQgMTguMDA5NyAxMi4zMDhDMTguMjI0OSAxMi45MDUzIDE4LjM3MzUgMTMuNTI0NCAxOC40NTI4IDE0LjE1NDNDMTguNTM3NSAxNC44NDMgMTguMzUxNyAxNS41Mzc3IDE3LjkzNDUgMTYuMDkyNUMxNy43Njg4IDE2LjMxNTEgMTcuNTY4MyAxNi41MDk4IDE3LjM0MDggMTYuNjY4OUwxNy4yNDg5IDE2LjczNTdWMTYuNjg1NkMxNy40NzI4IDE2LjI3MTEgMTcuNTkgMTUuODA3NCAxNy41OSAxNS4zMzY0QzE3LjU5IDE0Ljg2NTQgMTcuNDcyOCAxNC40MDE3IDE3LjI0ODkgMTMuOTg3MkMxNy4wNzMzIDEzLjU5NDUgMTYuODgxIDEzLjIzNTMgMTYuNjgwMyAxMi44MjZDMTYuMzkwMSAxMi4yNTAzIDE2LjE3MTEgMTEuNjQxNiAxNi4wMjgxIDExLjAxMzFDMTUuOTUxNiAxMC42NzU5IDE1LjkxMjQgMTAuMzMxMyAxNS45MTExIDkuOTg1NTJDMTUuOTQ5NSA4Ljk3NzQ0IDE2LjIxODMgNy45OTE1MSAxNi42OTcgNy4xMDMzMUMxNi45Mzk1IDYuNTc3IDE3LjIxNTQgNi4wODQxIDE3LjQxNjEgNS41NTc3OEMxNy41MDQgNS4zMTc3OSAxNy41NjI5IDUuMDY4MTkgMTcuNTkxNyA0LjgxNDI2QzE3LjYyNjYgNC40MDEwMSAxNy41NzI1IDMuOTg1MDggMTcuNDMyOCAzLjU5NDU0QzE3LjM4MjYgMy40NTI1MiAxNy4zMjQxIDMuMzEwNSAxNy4yNjU2IDMuMTY4NDhaIiBmaWxsPSIjRjBGNkZDIi8+DQo8cGF0aCBkPSJNMTkuMDc5OSA3LjYwNDU3QzE5LjE4MzkgNy42NTM4OCAxOS4yNzk3IDcuNzE4NjYgMTkuMzY0MiA3Ljc5NjcxQzE5LjYzNDkgOC4wMzIyOSAxOS44MjI1IDguMzQ4NjMgMTkuODk5MyA4LjY5ODk3QzE5Ljk1NzcgOS4wNjYyOCAxOS45NzQ1IDkuNDM5IDE5Ljk0OTUgOS44MTAwOEMyMC4wMTY4IDEwLjIzOTEgMjAuMDE2OCAxMC42NzYgMTkuOTQ5NSAxMS4xMDVDMTkuODQwMiAxMS41MTYxIDE5LjU3MjcgMTEuODY3NSAxOS4yMDUzIDEyLjA4MjRMMTkuMDU0OCAxMi4xNjZWMTIuMDgyNEMxOS4wNzI1IDExLjgwNDIgMTkuMDcyNSAxMS41MjUyIDE5LjA1NDggMTEuMjQ3QzE5LjAzNzQgMTEuMDk2MiAxOS4wMDM4IDEwLjk0NzggMTguOTU0NSAxMC44MDQyQzE4Ljg1MzQgMTAuNTE3OSAxOC43ODYgMTAuMjIwNyAxOC43NTM4IDkuOTE4NjlDMTguNzQ5OSA5Ljg2MzA2IDE4Ljc0OTkgOS44MDcyMyAxOC43NTM4IDkuNzUxNkMxOC43NTU5IDkuNTI5MSAxOC43ODQgOS4zMDc2MSAxOC44Mzc1IDkuMDkxNjJDMTguODM3NSA4LjkyNDUzIDE4LjkxMjcgOC43NjU4IDE4Ljk0NjIgOC41OTg3MkMxOC45OTU1IDguMjg5MTEgMTkuMDIzNCA3Ljk3NjQ4IDE5LjAyOTggNy42NjMwNVY3LjYyMTI4TDE5LjA3OTkgNy42MDQ1N1oiIGZpbGw9IiNGMEY2RkMiLz4NCjxwYXRoIGQ9Ik0xMS42ODA0IDE3LjI1MzdDMTAuNTk0OCAxNy4yNjIgOS41MTYyOSAxNy4wNzgxIDguNDk0ODMgMTYuNzEwN0M4LjAxMjYxIDE2LjUzNzggNy41NDc4OCAxNi4zMTk2IDcuMTA2OSAxNi4wNTlDNi42NzQ2NiAxNS44MTk1IDYuMjY1OTUgMTUuNTM5NyA1Ljg4NjE4IDE1LjIyMzZDNS41MTM1MSAxNC45MDg2IDUuMTc0NDcgMTQuNTU1OCA0Ljg3NDUgMTQuMTcxQzQuNTc4NDIgMTMuNzg2MSA0LjMxODE0IDEzLjM3NTEgNC4wOTY5MiAxMi45NDI5QzMuODg4MTcgMTIuNTAzNCAzLjcyMjk1IDEyLjA0NDUgMy42MDM2MiAxMS41NzI4QzMuMzgwNzEgMTAuNjAyNCAzLjM4MDcxIDkuNTk0MTggMy42MDM2MiA4LjYyMzc4QzMuNzIyOTUgOC4xNTIxMSAzLjg4ODE3IDcuNjkzMjIgNC4wOTY5MiA3LjI1MzY5QzQuNTMxODkgNi4zNjUzNSA1LjE0MDI0IDUuNTcyODcgNS44ODYxOCA0LjkyMjg2QzYuMjY3ODIgNC42MDkyIDYuNjc2MjkgNC4zMjk2NiA3LjEwNjkgNC4wODc0NEM3LjU0Nzg4IDMuODI2ODcgOC4wMTI2MSAzLjYwODY5IDguNDk0ODMgMy40MzU4MUM5LjUxNDIyIDMuMDU2OTggMTAuNTkyOCAyLjg2MTgxIDExLjY4MDQgMi44NTkzN0MxMS45NTYzIDIuODU5MzcgMTIuMjQwNiAyLjg1OTM3IDEyLjUxNjUgMi44NTkzN0wxMi4zODI3IDQuNDI5OTZDMTIuMTUxNiA0LjQxNzI3IDExLjkxOTkgNC40MTcyNyAxMS42ODg4IDQuNDI5OTZDOC4wMTgyNSA0LjQyOTk2IDQuOTk5OTEgNi45MzYyMyA0Ljk5OTkxIDEwLjA1MjRDNC45OTk5MSAxMy4xNjg1IDcuOTg0ODEgMTUuNjgzMSAxMS42ODg4IDE1LjY4MzFDMTEuOTkwNSAxNS42ODMzIDEyLjI5MTkgMTUuNjY2NiAxMi41OTE3IDE1LjYzM0wxMi43NzU3IDE3LjE5NTJDMTIuNDEyMSAxNy4yMzYxIDEyLjA0NjMgMTcuMjU1NiAxMS42ODA0IDE3LjI1MzdaIiBmaWxsPSIjRjBGNkZDIi8+DQo8cGF0aCBkPSJNMTEuMzg3OCAxNC43MjI0QzEwLjE4NzkgMTQuMzk3MiA5LjA4MjA1IDEzLjc5MzIgOC4xNjAzOSAxMi45NTk2QzcuNzUzNSAxMi41Nzg0IDcuNDE2NzMgMTIuMTI4OCA3LjE2NTQzIDExLjYzMTNDNi45MTY3NiAxMS4xMzMyIDYuNzg3OTMgMTAuNTgzOSA2Ljc4OTE4IDEwLjAyNzNDNi43OTI5NyA5LjQ2Mzk2IDYuOTI3NDkgOC45MDkxOCA3LjE4MjE1IDguNDA2NTdDNy40NDYzOCA3LjkwODI4IDcuNzk0MjMgNy40NTg5OCA4LjIxMDU2IDcuMDc4MjVDOS4xNjg1MiA2LjIzNDA3IDEwLjMxNTYgNS42MzIzNyAxMS41NTUgNS4zMjM4N0wxMS45NzMgNi44MzU5OEMxMC45Nzc2IDcuMDgxMDkgMTAuMDU0NyA3LjU1OTMgOS4yODA3NyA4LjIzMTEzQzkuMDA4OTMgOC40NTAyNCA4Ljc4NDg3IDguNzIyNjMgOC42MjIzOCA5LjAzMTU0QzguNDU5ODkgOS4zNDA0NCA4LjM2MjQyIDkuNjc5MzIgOC4zMzU5NyAxMC4wMjczQzguMzU1NzkgMTAuMzY3NSA4LjQ0MzY5IDEwLjcwMDIgOC41OTQ0OCAxMS4wMDU5QzguNzQ1MjggMTEuMzExNSA4Ljk1NTkgMTEuNTgzOSA5LjIxMzg4IDExLjgwNjdDOS45NTI1MiAxMi40Njc2IDEwLjgzODIgMTIuOTQzIDExLjc5NzQgMTMuMTkzNUwxMS4zODc4IDE0LjcyMjRaIiBmaWxsPSIjRjBGNkZDIi8+DQo8L2c+DQo8ZGVmcz4NCjxjbGlwUGF0aCBpZD0iY2xpcDBfMV8yIj4NCjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0id2hpdGUiLz4NCjwvY2xpcFBhdGg+DQo8L2RlZnM+DQo8L3N2Zz4=',
            30
        );
    }

    /**
     * render html in menu function
     *
     * @return void
     * @since 1.0.0
     */
    public function render_page() {
        echo '<div class="wrap"><div id="optimator-dashboard-app"></div></div>';
    }

    /**
     * remove all notices from menu function
     *
     * @return void
     * @since 1.0.0
     */
    public function remove_all_notices() {
        if (!$this->is_page()) return;
        remove_all_actions('admin_notices');
        remove_all_actions('all_admin_notices');
        remove_all_actions('user_admin_notices');
    }

    /**
     * is menu page check function
     *
     * @return boolean
     * @since 1.0.0
     */
    public function is_page() {
        return (isset($_GET['page']) && (sanitize_text_field($_GET['page']) === $this->slug));
    }
}
